function res = intergGaussQuad(fcn, a, b, order)
%INTERGGAUSSQUAD intergration by Gaussian quadrature
%   fcn: vector-valued function handle
%   a, b: interval
%   order: polynomial order >= 1

%% Predefined knots and weights , 1~10 order ([-1, 1])
knots = {0;
                [0.577350269189626, -0.577350269189626];
                [0.774596669241483, 0, -0.774596669241483];
                [0.861136311594053 0.339981043584856 -0.339981043584856 -0.861136311594053];
                [0.906179845938664 0.538469310105683 0 -0.538469310105683 -0.906179845938664];
                [0.932469514203152 0.661209386466265 0.238619186083197 -0.238619186083197 -0.661209386466265 -0.932469514203152];
                [0.949107912342758 0.741531185599395 0.405845151377397 0 -0.405845151377397 -0.741531185599395 -0.949107912342758];
                [0.960289856497536 0.796666477413627 0.525532409916329 0.183434642495650 -0.183434642495650 -0.525532409916329 -0.796666477413627 -0.960289856497536];
                [0.968160239507626 0.836031107326636 0.613371432700590 0.324253423403809 0 -0.324253423403809 -0.613371432700590 -0.836031107326636 -0.968160239507626];
                [0.973906528517172 0.865063366688985 0.679409568299024 0.433395394129247 0.148874338981631 -0.148874338981631 -0.433395394129247 -0.679409568299024 -0.865063366688985 -0.973906528517172]};

weights = {2; 
                    [1, 1];
                    [0.555555555555554 0.888888888888889 0.555555555555554];
                    [0.347854845137454 0.652145154862546 0.652145154862546 0.347854845137454];
                    [0.236926885056189 0.478628670499366 0.568888888888889 0.478628670499366 0.236926885056189];
                    [0.171324492379171 0.360761573048139 0.467913934572691 0.467913934572691 0.360761573048139 0.171324492379171];
                    [0.129484966168870 0.279705391489277 0.381830050505119 0.417959183673469 0.381830050505119 0.279705391489277 0.129484966168870];
                    [0.101228536290377 0.222381034453374 0.313706645877887 0.362683783378362 0.362683783378362 0.313706645877887 0.222381034453374 0.101228536290377];
                    [0.0812743883615746 0.180648160694857 0.260610696402936 0.312347077040003 0.330239355001260 0.312347077040003 0.260610696402936 0.180648160694857 0.0812743883615746];
                    [0.0666713443086880 0.149451349150581 0.219086362515982 0.269266719309996 0.295524224714753 0.295524224714753 0.269266719309996 0.219086362515982 0.149451349150581 0.0666713443086880]};

%% Extract knots and weights
if order<=10
    curKnots = knots{order};
    curWeights = weights{order};
else
    [curKnots, curWeights] = lgwt(order,-1,1);
end

%% Gaussian quadrature
transKnots = (a*(1-curKnots)+b*(1+curKnots))/2;   
transWeights = (b-a)/2 .* curWeights;

res = 0;
for i = 1:order
    res = res + transWeights(i) * fcn(transKnots(i));
end